angular.module('classApp',['ui.router'])
    .config(function($stateProvider,$urlRouterProvider){
        $urlRouterProvider.otherwise("/");
        $stateProvider.state('/',{
            url:'/',
            views:{
                '':{
                    templateUrl:'pages/home.html'
                }
            }
        }).state('/reg',{
            url:'/reg',
            views:{
                '':{
                    templateUrl:'pages/reg.html',
                    controller:'RegCtrl'
                }
            }
        }).state('/login',{
            url:'/login',
            views:{
                '':{
                    templateUrl:'pages/login.html',
                    controller:'LoginCtrl'
                }
            }
        }).state('/student',{
            url:'/student',
            views:{
                '':{
                    templateUrl:'pages/student.html',
                    controller:'StuCtrl'
                }
            }
        }).state('/exercise',{
            url:'/exercise',
            views:{
                '':{
                    templateUrl:'pages/exercise.html',
                    controller:'ExerCtrl'
                }
            }
        }).state('/detail',{
            url:'/detail',
            views:{
                '':{
                    templateUrl:'pages/detail.html',
                    controller:'DetailCtrl'
                }
            }
        }).state('/change',{
            url:'/change',
            views:{
                '':{
                    templateUrl:'pages/change.html',
                    controller:'ChangeCtrl'
                }
            }
        })
    }).run(function($rootScope,$location,$http){
        $http({
            url:'/users/validate',
            method:'GET'
        }).success(function(user){
            $rootScope.me = user;
            $location.path('/');
        }).error(function(data){
            $location.path('/login');
        });
    });